/*! grapesjs-custom-code - 0.1.11 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["grapesjs-custom-code"]=t():e["grapesjs-custom-code"]=t()}(window,function(){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.keyCustomCode="custom-code-plugin__code",t.typeCustomCode="custom-code",t.commandNameCustomCode="custom-code:open-modal"},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},i=a(o(2)),r=a(o(3)),s=a(o(4));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("opts  ",t);var o=n({blockLabel:"Custom Code2",blockCustomCode:{},propsCustomCode:{},placeholderContent:"<span>Insert here your custom code</span>",toolbarBtnCustomCode:{},placeholderScript:'<div style="pointer-events: none; padding: 10px;">\n      <svg viewBox="0 0 24 24" style="height: 30px; vertical-align: middle;">\n        <path d="M13 14h-2v-4h2m0 8h-2v-2h2M1 21h22L12 2 1 21z"></path>\n        </svg>\n      Custom code with <i>&lt;script&gt;</i> can\'t be rendered on the canvas\n    </div>',modalTitle:"Insert your code",codeViewOptions:{},buttonLabel:"Save",commandCustomCode:{}},t);(0,i.default)(e,o),(0,r.default)(e,o),(0,s.default)(e,o)}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},i=o(0);t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.DomComponents,r=o.getType("default"),s=r.model,a=t.toolbarBtnCustomCode,c=void 0;o.addType("script",{view:{onRender:function(){this.model.closestType(i.typeCustomCode)&&(this.el.innerHTML="")}}}),o.addType(i.typeCustomCode,{model:s.extend({defaults:n({},s.prototype.defaults,{name:"Custom Code",editable:!0},t.propsCustomCode),init:function(){this.listenTo(this,"change:"+i.keyCustomCode,this.onCustomCodeChange);var e=this.get(i.keyCustomCode)||t.placeholderContent;!this.components().length&&this.components(e);var o=this.get("toolbar"),r="custom-code";a&&!o.filter(function(e){return e.id===r}).length&&o.unshift(n({id:r,command:i.commandNameCustomCode,label:'<svg viewBox="0 0 24 24">\n              <path d="M14.6 16.6l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4m-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4z"></path>\n            </svg>'},a))},onCustomCodeChange:function(){this.components(this.get(i.keyCustomCode))}},{isComponent:function(){return!1}}),view:r.view.extend({events:{dblclick:"onActive"},init:function(){this.listenTo(this.model.components(),"add remove reset",this.onComponentsChange),this.onComponentsChange()},onComponentsChange:function(){var e=this;c&&clearInterval(c),c=setTimeout(function(){var o=e.model,n=1;(o.get(i.keyCustomCode)||"").indexOf("<script")>=0&&(e.el.innerHTML=t.placeholderScript,n=0),o.set({droppable:n})},0)},onActive:function(){var e=this.model;this.em.get("Commands").run(i.commandNameCustomCode,{target:e})}})})}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},i=o(0);t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.BlockManager,r=t.blockCustomCode,s=t.blockLabel;r&&o.add(i.typeCustomCode,n({label:'<svg viewBox="0 0 24 24">\n        <path d="M14.6 16.6l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4m-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4z"></path>\n      </svg>\n      <div>'+s+"</div>",category:"Extra",activate:!0,select:!0,content:{type:i.typeCustomCode}},r))}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},i=o(0);t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.Commands,r=t.modalTitle,s=t.codeViewOptions,a=t.commandCustomCode,c={},d=function(e,t){t instanceof HTMLElement?e.appendChild(t):t&&e.insertAdjacentHTML("beforeend",t)};o.add(i.commandNameCustomCode,n({keyCustomCode:i.keyCustomCode,run:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.editor=e,this.options=o,this.target=o.target||e.getSelected();var n=this.target;n&&n.get("editable")&&this.showCustomCode(n)},stop:function(e){e.Modal.close()},showCustomCode:function(e){var t=this,o=this.editor,n=this.options.title||r,s=this.getContent(),a=e.get(i.keyCustomCode)||"";o.Modal.open({title:n,content:s}).getModel().once("change:open",function(){return o.stopCommand(t.id)}),this.getCodeViewer().setContent(a)},getPreContent:function(){var e=t.isCodeSnippet,o=void 0!==e&&e,n=t.code_ui,i=t.languages,r=void 0===i?[]:i;console.log("isCodeSnippet ",o);var s=document.createElement("div");if(o)if(n)s.innerHTML=n;else{var a=["plain","plaintext","text","markup","html","svg","xml","ssml","atom","css","javascript","java"];Object.assign(a,r),s.className="gjs-one-bg gjs-two-color gjs-code-snippet";var d=a.map(function(e){return"<option value="+e+">"+function(e){return e&&e[0].toUpperCase()+e.slice(1)}(e)+"</option>"}).join("");s.innerHTML='<div class="gjs-row">\n          <div class="gjs-cell" id="iyd4">\n          <input type="checkbox" id="enableCodeSelect"/><label for="enableCodeSelect">Is code snippet</label></div>\n          <div class="gjs-cell" id="isyr"><select id="language-change" class="gjs-select" style="display:none"><option value="">Select a language</option>'+d+"</select>\n          </div>\n        </div>";var l=s.querySelector("#language-change");s.querySelector("#enableCodeSelect").addEventListener("click",function(e){var t=e.currentTarget.checked;l.style.display=t?"block":"none",c.enableCode=t,console.log("enableCodeSelect ",e,t)}),l.addEventListener("change",function(e){console.log("language-change ",e),c.language=e.currentTarget.value})}return s},getPostContent:function(){},getContent:function(){var e=this.editor,t=document.createElement("div"),o=this.getCodeViewer(),n=e.getConfig("stylePrefix");return t.className=n+"custom-code",d(t,this.getPreContent()),t.appendChild(o.getElement()),d(t,this.getPostContent()),d(t,this.getContentActions()),o.refresh(),setTimeout(function(){return o.focus()},0),t},getContentActions:function(){var e=this,o=this.editor,n=document.createElement("button"),i=o.getConfig("stylePrefix");return n.innerHTML=t.buttonLabel,n.className=i+"btn-prim "+i+"btn-import__custom-code",n.onclick=function(){return e.handleSave()},n},handleSave:function(){var e=this.editor,t=this.target,o=c.language,n=c.enableCode,r=this.getCodeViewer().getContent();n&&(r='<pre class="language-'+o+'"><code>'+r+"</code></pre>"),t.set(i.keyCustomCode,r),e.Modal.close()},getCodeViewer:function(){var e=this.editor;return this.codeViewer||(this.codeViewer=e.CodeManager.createViewer(n({codeName:"htmlmixed",theme:"hopscotch",readOnly:0},s))),this.codeViewer}},a))}}])});
//# sourceMappingURL=grapesjs-custom-code.min.js.map